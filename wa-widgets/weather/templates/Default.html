<style>

    .s-weather { padding: 0 0 3em; background: #1c60ac; text-align: center; height: 100%; color: #fff; font-size: 16px; }
    .s-weather .s-weather-icon { width: 16em; height: 16em; background-size: 16em 16em; margin: -2.5em auto 0; }
    .s-weather h2 { font-weight: normal; margin: -0.703125em 0 0 0.35em; font-size: 4em; }
    .s-weather h4 { opacity: 0.8; font-weight: normal; }
    
    .widget-1x1 .s-weather-icon,
    .widget-2x1 .s-weather-icon { width: 128px; height: 128px; background-size: 128px 128px; margin-top: -15px; }
    .widget-1x1 .s-weather h2,
    .widget-2x1 .s-weather h2 { margin: -0.390625em 0 0.078125em; }
    .widget-2x1 .s-weather h6 { font-size: 0.8em; }
    .widget-2x2 .s-weather h6 { font-size: 1.3em; }

    .wa-no-weather { padding: 2em 0; font-weight: normal; color: #fff; }
    .widget-2x1 .wa-no-weather { padding: 2em 2.75em; }
    .widget-2x2 .wa-no-weather { padding: 4em 1.5em; }

    /* weather condition codes accroding to openweathermap.org */
    
    .s-weather-day { background: -moz-linear-gradient(top,  rgba(19,54,130,1) 0%, rgba(39,147,223,1) 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(19,54,130,1)), color-stop(100%,rgba(39,147,223,1))); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  rgba(19,54,130,1) 0%,rgba(39,147,223,1) 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  rgba(19,54,130,1) 0%,rgba(39,147,223,1) 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  rgba(19,54,130,1) 0%,rgba(39,147,223,1) 100%); /* IE10+ */
        background: linear-gradient(to bottom,  rgba(19,54,130,1) 0%,rgba(39,147,223,1) 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#133682', endColorstr='#2793df',GradientType=0 ); /* IE6-9 */
     }
    .s-weather-night { background: #0f2657 url('{$wa_url}wa-widgets/weather/img/night.jpg') no-repeat; background-size: cover; }
    .s-weather-notavailable { background: #aaa; }

    /* TV */
    {$_color_1 = "#0f2d62"}
    {$_color_2 = "#1b679c"}
    .tv .s-weather-day {
        background: -moz-linear-gradient(top, {$_color_1} 0%, {$_color_2} 100%);
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, {$_color_1}), color-stop(100%, {$_color_2}));
        background: -webkit-linear-gradient(top, {$_color_1} 0%, {$_color_2} 100%);
        background: -o-linear-gradient(top, {$_color_1} 0%, {$_color_2} 100%);
        background: -ms-linear-gradient(top, {$_color_1} 0%, {$_color_2} 100%);
        background: linear-gradient(to bottom, {$_color_1} 0%, {$_color_2} 100%);
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='{$_color_1}', endColorstr='{$_color_2}',GradientType=0 );
    }

    .tv .s-weather { font-size: 1rem; }

</style>

<div class="s-weather s-weather-{if empty($weather.weather.icon)}notavailable{else}{if $weather.weather.icon|strstr:'n'}night{else}day{/if}{/if}" id="s-weather-widget-{$info['id']}">

    {if empty($weather) || !empty($weather.message)}
        {if !empty($weather.message) && $weather.message !== 'Error: Not found city'}
            <div class="errormsg">{$weather.message}</div>
        {else if $city}
            <h5 class="align-center hint wa-no-weather">{sprintf('[`Could not retrieve weather conditions for <strong>%s</strong>. Please check city name in widget settings or in your contact info.`]', $city|escape|default:'[`(unknown city)`]')}</h5>
        {else}
            <h5 class="align-center hint wa-no-weather">[`Please enter city name in your contact information or in this widget settings.`]</h5>
        {/if}
    {else}

        {*src="{$wa_url}wa-widgets/weather/img/11.png"*}
        <div class="s-weather-icon" style="background-image: url('{$wa_url}wa-widgets/weather/img/{$weather.weather.icon|default:'unknown'}.png');"></div>

        <h2>{$weather.main.temp}&deg;</h2>
        <h6>{$city|escape}</h6>
        
    {/if}
</div>

<script>
( function($) {
    var time = 15 * 60 * 1000;

    setTimeout(function() {
        var widget_id = "{$info['id']}",
            widget = ( DashboardWidgets.hasOwnProperty(widget_id) ) ? DashboardWidgets[widget_id] : false;

        if (widget) {
            widget.renderWidget();
        }
    }, time);

})(jQuery);
</script>

{*
{if !$wa->get('ignore_js')}
    <script>
    ( function($) { "use strict";

        var timer_id;

        var updateWidget = function() {
            var $container = $('#s-weather-widget-{$info['id']}');

            if ($container.length && $.contains(document, $container[0])) {
                var app_href = "{$wa_app_url}?widget={$info.widget}&id={$info.id}&size={$info.size}&nocache=1&ignore_js=1";

                $.get(app_href, function (html) {
                    var $tmp = $('<div>').html(html);
                    //
                    $container.find('.s-weather').replaceWith($tmp.find('.s-weather'));
                    //
                    $tmp.remove();
                });

            } else {
                clearInterval(timer_id);
            }
        };

        $( function() {
            //
            timer_id = setInterval(updateWidget, 3600000);
            //
            $.wa.updateWeatherWidget = updateWidget;
        });
    })(jQuery);
    </script>
{/if}
*}